Этот проект - это ВУЗовские лабораторные работы по курсу "Объектно-ориентированное программирование".

Задания были следующими:

#### ЛАБОРАТОРНАЯ РАБОТА №1
#### "Создание Windows-приложений. Обработка событий мыши. Вывод текста в окно."

1. Ознакомиться со средой проектирования Visual Studio.NET

2. Создать простейшее приложение средствами Studio.NET.

3. Изменить размеры окна приложения, цвет фона и заголовок.

4. Реализовать обработку щелчка левой и правой кнопки мыши. По левой кнопке - выводить координаты курсора мыши в точке его нахождения. По правой – отображать диалоговое окно с сообщением «Нажата правая кнопка мыши» и очищать окно приложения от надписей.

#### ЛАБОРАТОРНАЯ РАБОТА №2
#### "Создание многооконного приложения, имеющего меню. Рисование прямоугольников под управлением мыши."

1. Сделать окно приложения MDI-контейнером.

2. Создать меню приложения, содержащее на верхнем уровне пункт «Окно», а в распахиваюшемся списке команду «Новое» и список открытых окон. Реализовать обработку команды создания нового окна.

3. Реализовать рисование на экране прямоугольников под управлением мыши. При нажатии левой кнопки мыши и ее удержании при перемещении мыши потенциальный прямоугольник должен отображаться пунктиром, при отпускании кнопки мыши прямоугольник должен выводиться сплошной линией. Должно рисоваться произвольное число прямоугольников.

#### ЛАБОРАТОРНАЯ РАБОТА №3
#### "Проектирование иерархии классов. Использование контейнерных классов. Перерисовка графической информации."

1. Спроектировать базовый класс для моделирования различных геоматрических фигур.

2. Спроектировать класс, моделирующий прямоугольник, как производный от класса, спроектированного в пункте 1 задания.

3. Реализовать сохранение информации об изображении в динамическом массиве объектов, имеющих тип класса, спроектированного в пункте 1 задания.

4. Реализовать перерисовку графического изображения, создаваемого в программе.

#### ЛАБОРАТОРНАЯ РАБОТА №4
#### "Сохранение документов в файлах."

1. Добавить в меню программы команды сохранения и открытия файлов. Реализовать сохранение рисунков в файлах и чтение их из файлов. После сохранения файла заголовок окна соответствующего документа должен содержать имя файла. При открытии файла его имя должно использоваться в качестве заголовка окна. Пока нет ни одного открытого окна документа, команды сохранения файла должны быть в заблокированном состоянии.

2. Для измененных документов при закрытии окна следует выдавать диалоговое окно с запросом о сохранении документа и обрабатывать три варианта выбора пользователя – сохранение, отказ от сохранения и отказ от закрытия окна (Yes-No-Cancel).

#### ЛАБОРАТОРНАЯ РАБОТА №5
#### "Управление атрибутами графического вывода. Использование окон диалога."

1. Дополнить модель фигуры атрибутами цвета линии, цвета фона фигуры, толщины линии. Реализовать сохранение этих атрибутов в файлах. Использовать эти атрибуты при рисовании прямоугольников.

2. Добавить в меню верхнего уровня пункт "Параметры". В подменю поместить пункты "Цвет линии", "Цвет фона", "Толщина линии".

3. Реализовать создание соответствующих диалоговых панелей для обработки новых команд меню и использование результатов ввода в программе. В диалоговом окне выбора размера пера использовать комбинированный список с полем ввода (combobox), содержащий список фиксированных размеров(1, 2, 5, 8, 10, 12, 15) .

Выбранные в диалоговых панелях параметры должны использоваться при рисовании фигур во всех открытых в редакторе окнах. По умолчанию при запуске программы должны использоваться чёрный цвет линии, белый цвет фона и единичная толщина линии.

#### ЛАБОРАТОРНАЯ РАБОТА №6
#### "Управление размером рисунка. Прокрутка изображения."

1. Ввести в меню команду настройки размеров для вновь создаваемых рисунков. Вызываемая диалоговая панель должна содержать выбор размера (c использованием radio-кнопок) из трех фиксированных вариантов (320x240, 640x480, 800x600), флажок выбора ручного ввода размера, поля ввода ширины и высоты рисунка в пикселях. Выбор размера не должен изменять размеры уже существующих рисунков, а должен определять размеры рисунков, создаваемых в дальнейшем командой «Новый».

2. Рисунок должен отображаться и записываться в файл с учетом своего размера. Фон области формы, находящийся вне рисунка, должен отображаться светло-серым цветом. Если при завершении рисования фигуры будет происходить выход контура фигуры за границы рисунка, соответствующая фигура не должна добавляться к рисунку.

3. Дополнить окна документов полосами прокрутки, обеспечить корректное отображение рисунков при скроллинге.

#### ЛАБОРАТОРНАЯ РАБОТА №7
#### "Развитие иерархии классов. Оптимизация операций рисования."

1. Спроектировать классы, обеспечивающие рисование и сохранение в файлах помимо прямоугольников также эллипсов, прямых линий и линий произвольной формы. Рисование линии произвольной формы должно начинаться по нажатию на левую кнопку мыши и завершаться по её отпусканию.

2. Дополнить меню программы разделом «Фигура», пункты которого должны обеспечивать выбор режима рисования одной из фигур. Пункт меню, соответствующий выбранной фигуре, должен отмечаться галочкой. Для замкнутых фигур (прямоугольника и эллипса) должны поддерживаться режимы прозрачного фона и заливки фона фигуры выбранным цветом фона. Для выбора режима заливки в меню «Фигура» ввести пункт «Заливка», который должен работать как флаг, последовательно устанавливаемый и сбрасываемый при его выборе. Активность режима заливки должна отображаться галочкой рядом с пунктом меню.

3. Обеспечить сохранение целостности исходного изображения в процессе добавления новых фигур к рисунку (отсутствие в окне «мусора» и стёртых фрагментов фигур). Обеспечить отсутствие мерцания (мелькания фона) при добавлении новых фигур и изменении размеров окна.

#### ЛАБОРАТОРНАЯ РАБОТА №8
#### "Строка состояния. Панель инструментов."

1. Добавить в редактор строку состояния. Реализовать вывод в строке состояния информации о выбранном размере пера, цвете пера и цвете заливки, а также вывод координат курсора мыши и размера рисунка в пикселях.

2. Спроектировать кнопочную панель, содержащую кнопки создания нового документа, сохранения документа, открытия документа, выбора размера пера, цвета пера, цвета заливки фона, размера вновь создаваемого изображения и группу кнопок выбора режима рисования фигуры – прямоугольника, эллипса, прямой линии, линии произвольной формы. Группа должна быть реализована как группа кнопок с зависимой фиксацией. Также разместить на панели независимую кнопку включения /выключения заливки. Обеспечить обработку событий от кнопок панели.

#### ЛАБОРАТОРНАЯ РАБОТА №9
#### "Вывод текста с использованием различных шрифтов."

1. Дополнить меню редактора и кнопочную панель управления командами выбора шрифта по умолчанию и выбора режима ввода текстовых надписей. Команда выбора шрифта должна вызывать стандартное диалоговое окно выбора шрифта.

2. В режиме ввода текста левой кнопкой мыши должны задаваться размеры и положение блока ввода текста. Ввод текста должен завершаться нажатием клавиши «Enter», после чего введенная текстовая надпись должна отображаться как элемент рисунка. При выводе должен использоваться текущий цвет пера как цвет выводимого текста.

3. Текстовые надписи должны сохраняться в файле вместе с графическими элементами рисунка.

4. В строке состояния в режиме ввода текста должны отображаться в качестве дополнительных параметров название шрифта и его размер.

#### ЛАБОРАТОРНАЯ РАБОТА №10
#### "Редактирование рисунка. Выделение элемента и блока. Перетаскивание. Удаление."

1. Добавить в кнопочное меню редактора кнопку режима выделения фигур. Эта кнопка должна быть с фиксацией. В режиме выделения при однократном нажатии левой кнопки мыши должна выделяться та фигура, в прямоугольном блоке которой находился в этот момент указатель мыши. Под прямоугольным блоком фигуры здесь понимается прямоугольник, в который вписывается данная фигура. Перемещение мыши с нажатой левой кнопкой должно приводить к выделению набора фигур, прямоугольные блоки которых пересекаются с прямоугольником выделения, который должен отображаться пунктирной линией в процессе выделения. После выделения выделенные фигуры должны отображаться с наложенным на обычный рисунок пунктирным контуром (для текстового блока – прямоугольник блока). Новая операция выделения блока с перемещением мыши или её попытка должны отменять предыдущие выделения фигур. Щелчок по фигуре без перемещения мыши должен добавлять очередную фигуру к существующему набору выделенных фигур. Сохранять в файле признак выделения фигуры не следует.

2. Реализовать перетаскивание фигур блока в режиме выделения при наличии выделенных фигур и нажатии левой кнопки мыши в поле прямоугольной области любой выделенной фигуры с дальнейшим перемещением мыши. (Нажатие левой кнопки вне выделенных фигур должно обрабатываться как попытка следующего выделения.) При перемещении должны рисоваться пунктирные контуры потенциального нового положения фигур блока. При отпускании кнопки мыши блок или фигура должны отображаться на новом месте при условии непересечения ими границ рисунка. В противном случае операция должна игнорироваться.

3. Реализовать команду удаления выделенного блока или фигуры. Добавить соответствующий пункт в меню редактирования.

#### ЛАБОРАТОРНАЯ РАБОТА №11
#### "Операции с буфером обмена и метафайлом. Использование функций API Windows"

1. Добавить в редактор раздел «Правка» в меню верхнего уровня. Реализовать операции и команды меню:
a)	Копирование выделенного блока в системный буфер обмена (Clipboard) в собственном формате
b)	Копирование блока в Clipboard в формате метафайла. 
c)	Вырезание блока (копирование в буфер  с удалением).
d)	Вставка блока (в собственном формате) из буфера.
e)	«Выделить все» 

2. Команды меню, вызывающие операции с буфером обмена, должны блокироваться при отсутствии окон рисунков  и при отсутствии в рисунке активной формы выделенного блока (для команд копирования и вырезания).
Команда вставки из буфера должна блокироваться при отсутствии в буфере информации нужного формата.

3. При вставке в новое окно блок должен позиционироваться в левый верхний угол рисунка, вне зависимости от его положения в исходном рисунке. Если размеры блока превышают размеры рисунка, вставка выполняться не должна, а должно выводиться окно с сообщением о том, что блок превышает допустимые размеры.
4. Для  метафайла, передаваемого в буфер,  следует проверить  возможность вставки из буфера в программы MS Word, Excel, Paint.

#### ЛАБОРАТОРНАЯ РАБОТА №12
#### "Управление координатной сеткой."

1. Дополнить редактор возможностью включения /выключения отображения координатной сетки с регулируемым шагом. Сетка должна отображаться штриховой линией серого цвета единичной толщины.  Добавить в меню редактора соответствующие команды («Сетка» и «Шаг сетки» в раздел «Атрибуты»). Шаг сетки по умолчанию сделать 10x10 пикселей. Раздельно регулировать шаг сетки по  вертикальной и горизонтальной оси  не требуется. 
2. Добавить в меню (в раздел «Правка») команду «Выровнять по сетке», которая должна  перемещать точки привязки всех фигур рисунка в узлы выбранной сетки. Реализовать эту операцию для всех фигур. Для прямоугольника, эллипса, линии должны выравниваться по сетке обе точки, определяющие фигуру. Для текстового блока – координаты, задающие границы блока. Для кривой следует разработать алгоритм, который разместит её начальную и конечную точки в узлах сетки, а координаты промежуточных точек изменит так, чтобы сохранить  форму и гладкость  кривой.

3. Добавить в меню «Атрибуты» команду-флаг «Привязка к сетке». При выборе этого режима добавляемые к рисунку новые фигуры должны сразу выравниваться по узлам сетки.